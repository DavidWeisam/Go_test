<!DOCTYPE html>
<html lang="en">
<head>
  <!-- tailwind cdn -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            "black-background": "#151515",

            "critical-base": "#D01100",
            "critical-background": "#FFFBFA",
            "critical-border": "#FDA29B",

            "high-base": "#ED6A5E",
            "high-background": "#FFFBFA",
            "high-border": "#FDA29B",

            "medium-base": "#F4BD4F",
            "medium-background": "#FFFDF8",
            "medium-border": "#EFE1BC",

            "low-base": "#07B6CE",
            "low-background": "#E8FCFF",
            "low-border": "#009AAE",

            "none-background": "#F5F5F5",
            "none-border": "#E0E0E0",
          },
        },
      },
    };
  </script>

  <style>
    .modal-button {
      background: linear-gradient(#050f20, #050f20) padding-box,
        linear-gradient(rgba(208, 213, 221, 1), rgba(208, 213, 221, 0.4)) border-box;
      padding: 10px;
      font-size: 14px;
      font-weight: 600;
    }

    dialog::backdrop {
      -webkit-backdrop-filter: blur(2px);
      backdrop-filter: blur(2px);
      background: rgba(3, 10, 27, 0.7);
    }
  </style>

  <title>NB Defense Report</title>
</head>

<body>
  <div class="bg-black-background absolute h-72 w-full text-white z-0">
    <nav class="w-100 border-b-[1px] border-[#2D2D2D]">
  <div class="flex flex-row max-w-4xl m-auto h-14 items-center">
    <p class="inline-block ml-2">NB Defense Scan Results</p>
    <div class="ml-auto flex items-center">
      <a
        href="https://nbdefense.ai"
        target="_blank"
        rel="noreferrer"
        >Docs</a
      >
    </div>
  </div>
</nav>
  </div>
  <div class="max-w-4xl m-auto relative z-10 top-14 flex flex-col">
    <div class="text-white mt-14 mb-6 h-14 flex flex-row">
      <div class="flex flex-col">
        <div class="text-sm font-thin">
          /Users/david/Desktop/amazon_segemaker_examples/
        </div>
        <div class="text-3xl font-bold">
          mount_shasta_glacier_melt_monitoring.ipynb
        </div>
      </div>
      <div class="ml-auto">
        <button id="filesScannedButton" class="border border-[transparent] rounded-lg modal-button mr-2">View
          files scanned</button>
      </div>
    </div>

    <div
  class="grid grid-cols-8 h-35 bg-white border-solid border-1 border-[#D8D8D8] rounded-md shadow-[0_1px_3px_rgba(16,24,40,0.1),0_1px_2px_rgba(16,24,40,0.06)]">
  <div class="col-span-2 p-8">
    <h3 class="text-sm font-thin">Files</h3>
    <span class="text-3xl font-bold">1</span>
  </div>
  <div class="col-span-2 p-8">
    <h3 class="text-sm font-thin">Checks ran</h3>
    <span class="text-3xl font-bold">2</span>
  </div>
  <div class="col-span-4 p-8">
    <h3 class="text-sm font-thin">Scanned at</h3>
    <span class="text-3xl font-bold">Jul 21, 2024 &middot; 12:39 PM</span>
  </div>
</div>

    

    <div>
  <h3 class="text-lg font-bold mt-6">All issues</h3>
  
    <div class="flex flex-row items-center">
      <span
        class="rounded-md bg-critical-base text-white text-center h-6 w-6"
        >0</span
      >
      <h2 class="text-2xl font-bold ml-2">Critical</h2>
    </div>
     
      <div
  class="bg-none-background border-solid border border-none-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <h3>No issues were found at this severity level</h3>
</div> 
    
  
    <div class="flex flex-row items-center">
      <span
        class="rounded-md bg-high-base text-white text-center h-6 w-6"
        >7</span
      >
      <h2 class="text-2xl font-bold ml-2">High</h2>
    </div>
     
      
        
        <div
  class="bg-high-background border-solid border border-high-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <div class="mr-3">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clip-path="url(#clip0_1_7746)">
    <path
      d="M9.99999 6.66669V10M9.99999 13.3334H10.0083M18.3333 10C18.3333 14.6024 14.6024 18.3334 9.99999 18.3334C5.39762 18.3334 1.66666 14.6024 1.66666 10C1.66666 5.39765 5.39762 1.66669 9.99999 1.66669C14.6024 1.66669 18.3333 5.39765 18.3333 10Z"
      stroke="#D92D20" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  </g>
  <defs>
    <clipPath id="clip0_1_7746">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>
  </div>
  <div class="w-full">
  <h3 class="font-bold">PII Found</h3>
  <p class="mt-4">Path: mount_shasta_glacier_melt_monitoring.ipynb</p>
  <p class="mt-4"><b>Description</b>:</p>
  <p>A total of 2 PII found in cell number 3 with the following tag(s):</p>
  <p>
  <pre>{
    "LOCATION": 2
}</pre>
  </p>
  <p class="mt-4">
    <b>Location</b>: cell input
  </p>
  <div class="flex flex-row w-100 mt-4">
    <div class="pr-4">
      <p class="font-bold">Cell #3</p>
    </div>
    <div class="bg-white border-solid border border-none-border rounded-md overflow-x-auto w-[42rem]">
      <span class="pl-4">**Contents**
* [Setup SageMaker geospatial capabilities](#1)
* [Query Sentinel-2 Data](#2)
* [Start an Earth Observation Job (EOJ) to identify the land cover types in the area of [PII])
* [Visualize EOJ inputs and outputs in FourSquare Studio](#4)
* [Extract the land cover segmentation results](#5)
* [Measure snow coverage of [PII])
* [Query Landsat 8 data](#7)
* [Analyze the relationship between snow coverage and surface temperature](#8)

</span>
    </div>
  </div>
</div>
</div>
      
        
        <div
  class="bg-high-background border-solid border border-high-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <div class="mr-3">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clip-path="url(#clip0_1_7746)">
    <path
      d="M9.99999 6.66669V10M9.99999 13.3334H10.0083M18.3333 10C18.3333 14.6024 14.6024 18.3334 9.99999 18.3334C5.39762 18.3334 1.66666 14.6024 1.66666 10C1.66666 5.39765 5.39762 1.66669 9.99999 1.66669C14.6024 1.66669 18.3333 5.39765 18.3333 10Z"
      stroke="#D92D20" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  </g>
  <defs>
    <clipPath id="clip0_1_7746">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>
  </div>
  <div class="w-full">
  <h3 class="font-bold">PII Found</h3>
  <p class="mt-4">Path: mount_shasta_glacier_melt_monitoring.ipynb</p>
  <p class="mt-4"><b>Description</b>:</p>
  <p>A total of 1 PII found in cell number 5 with the following tag(s):</p>
  <p>
  <pre>{
    "PERSON": 1
}</pre>
  </p>
  <p class="mt-4">
    <b>Location</b>: cell input
  </p>
  <div class="flex flex-row w-100 mt-4">
    <div class="pr-4">
      <p class="font-bold">Cell #5</p>
    </div>
    <div class="bg-white border-solid border border-none-border rounded-md overflow-x-auto w-[42rem]">
      <span class="pl-4">import boto3
import [PII]
import sagemaker_geospatial_map

session = boto3.Session()
execution_role = sagemaker.get_execution_role()
sg_client = session.client(service_name="sagemaker-geospatial")</span>
    </div>
  </div>
</div>
</div>
      
        
        <div
  class="bg-high-background border-solid border border-high-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <div class="mr-3">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clip-path="url(#clip0_1_7746)">
    <path
      d="M9.99999 6.66669V10M9.99999 13.3334H10.0083M18.3333 10C18.3333 14.6024 14.6024 18.3334 9.99999 18.3334C5.39762 18.3334 1.66666 14.6024 1.66666 10C1.66666 5.39765 5.39762 1.66669 9.99999 1.66669C14.6024 1.66669 18.3333 5.39765 18.3333 10Z"
      stroke="#D92D20" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  </g>
  <defs>
    <clipPath id="clip0_1_7746">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>
  </div>
  <div class="w-full">
  <h3 class="font-bold">PII Found</h3>
  <p class="mt-4">Path: mount_shasta_glacier_melt_monitoring.ipynb</p>
  <p class="mt-4"><b>Description</b>:</p>
  <p>A total of 1 PII found in cell number 6 with the following tag(s):</p>
  <p>
  <pre>{
    "LOCATION": 1
}</pre>
  </p>
  <p class="mt-4">
    <b>Location</b>: cell input
  </p>
  <div class="flex flex-row w-100 mt-4">
    <div class="pr-4">
      <p class="font-bold">Cell #6</p>
    </div>
    <div class="bg-white border-solid border border-none-border rounded-md overflow-x-auto w-[42rem]">
      <span class="pl-4">&lt;a id='2'&gt;&lt;/a&gt;

## Query Sentinel-2 data

Retrieve Sentinel-2 data over the [PII] area by specifying the data location, time range, and property filters in the query.</span>
    </div>
  </div>
</div>
</div>
      
        
        <div
  class="bg-high-background border-solid border border-high-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <div class="mr-3">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clip-path="url(#clip0_1_7746)">
    <path
      d="M9.99999 6.66669V10M9.99999 13.3334H10.0083M18.3333 10C18.3333 14.6024 14.6024 18.3334 9.99999 18.3334C5.39762 18.3334 1.66666 14.6024 1.66666 10C1.66666 5.39765 5.39762 1.66669 9.99999 1.66669C14.6024 1.66669 18.3333 5.39765 18.3333 10Z"
      stroke="#D92D20" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  </g>
  <defs>
    <clipPath id="clip0_1_7746">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>
  </div>
  <div class="w-full">
  <h3 class="font-bold">PII Found</h3>
  <p class="mt-4">Path: mount_shasta_glacier_melt_monitoring.ipynb</p>
  <p class="mt-4"><b>Description</b>:</p>
  <p>A total of 1 PII found in cell number 8 with the following tag(s):</p>
  <p>
  <pre>{
    "LOCATION": 1
}</pre>
  </p>
  <p class="mt-4">
    <b>Location</b>: cell input
  </p>
  <div class="flex flex-row w-100 mt-4">
    <div class="pr-4">
      <p class="font-bold">Cell #8</p>
    </div>
    <div class="bg-white border-solid border border-none-border rounded-md overflow-x-auto w-[42rem]">
      <span class="pl-4">&lt;a id='3'&gt;&lt;/a&gt;
## Start an Earth Observation Job (EOJ) to identify the land cover types in the area of [PII]</span>
    </div>
  </div>
</div>
</div>
      
        
        <div
  class="bg-high-background border-solid border border-high-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <div class="mr-3">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clip-path="url(#clip0_1_7746)">
    <path
      d="M9.99999 6.66669V10M9.99999 13.3334H10.0083M18.3333 10C18.3333 14.6024 14.6024 18.3334 9.99999 18.3334C5.39762 18.3334 1.66666 14.6024 1.66666 10C1.66666 5.39765 5.39762 1.66669 9.99999 1.66669C14.6024 1.66669 18.3333 5.39765 18.3333 10Z"
      stroke="#D92D20" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  </g>
  <defs>
    <clipPath id="clip0_1_7746">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>
  </div>
  <div class="w-full">
  <h3 class="font-bold">PII Found</h3>
  <p class="mt-4">Path: mount_shasta_glacier_melt_monitoring.ipynb</p>
  <p class="mt-4"><b>Description</b>:</p>
  <p>A total of 1 PII found in cell number 14 with the following tag(s):</p>
  <p>
  <pre>{
    "LOCATION": 1
}</pre>
  </p>
  <p class="mt-4">
    <b>Location</b>: cell input
  </p>
  <div class="flex flex-row w-100 mt-4">
    <div class="pr-4">
      <p class="font-bold">Cell #14</p>
    </div>
    <div class="bg-white border-solid border border-none-border rounded-md overflow-x-auto w-[42rem]">
      <span class="pl-4"># Visualize AOI
config = {"label": "[PII]"}
aoi_layer = map.visualize_eoj_aoi(Arn=eoj_arn, config=config)</span>
    </div>
  </div>
</div>
</div>
      
        
        <div
  class="bg-high-background border-solid border border-high-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <div class="mr-3">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clip-path="url(#clip0_1_7746)">
    <path
      d="M9.99999 6.66669V10M9.99999 13.3334H10.0083M18.3333 10C18.3333 14.6024 14.6024 18.3334 9.99999 18.3334C5.39762 18.3334 1.66666 14.6024 1.66666 10C1.66666 5.39765 5.39762 1.66669 9.99999 1.66669C14.6024 1.66669 18.3333 5.39765 18.3333 10Z"
      stroke="#D92D20" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  </g>
  <defs>
    <clipPath id="clip0_1_7746">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>
  </div>
  <div class="w-full">
  <h3 class="font-bold">PII Found</h3>
  <p class="mt-4">Path: mount_shasta_glacier_melt_monitoring.ipynb</p>
  <p class="mt-4"><b>Description</b>:</p>
  <p>A total of 1 PII found in cell number 24 with the following tag(s):</p>
  <p>
  <pre>{
    "LOCATION": 1
}</pre>
  </p>
  <p class="mt-4">
    <b>Location</b>: cell input
  </p>
  <div class="flex flex-row w-100 mt-4">
    <div class="pr-4">
      <p class="font-bold">Cell #24</p>
    </div>
    <div class="bg-white border-solid border border-none-border rounded-md overflow-x-auto w-[42rem]">
      <span class="pl-4">overlay_dir = "./masks/mont_shasta_overlay"
os.makedirs(overlay_dir, exist_ok=True)
snow_areas = []
mask_dates = []

for image_file, mask_file in zip(image_files, mask_files):
    image_id = image_file.split("/")[-1].split("_TCI")[0]
    mask_id = mask_file.split("/")[-1].split(".tif")[0]
    mask_date = mask_id.split("_")[2]
    mask_dates.append(mask_date)
    assert image_id == mask_id
    image = tifffile.imread(image_file)
    image_ds = cv2.resize(image, (1830, 1830), interpolation=cv2.INTER_LINEAR)
    snow_mount_img = image_ds[100:400, 1000:1250]  # a crop of the [PII] area
    mask = tifffile.imread(mask_file)
    snow_mask = np.isin(mask, [11]).astype(np.uint8)  # extract snow mask
    snow_mount_mask = snow_mask[100:400, 1000:1250]
    snow_area = snow_mount_mask.sum() * 60 * 60 / (1000 * 1000)  # calculate the snow cover area
    snow_areas.append(snow_area)
    red_img = np.zeros(snow_mount_img.shape, snow_mount_img.dtype)
    red_img[:, :] = (255, 0, 0)
    red_mask = cv2.bitwise_and(red_img, red_img, mask=snow_mount_mask)
    overlay_img = cv2.addWeighted(red_mask, 1, snow_mount_img, 1, 0, snow_mount_img)
    cv2.putText(
        overlay_img,
        f"{mask_date}",
        (0, 20),
        cv2.FONT_HERSHEY_SIMPLEX,
        0.5,
        (255, 0, 0),
        1,
        cv2.LINE_AA,
    )
    cv2.putText(
        overlay_img,
        f"{snow_area} [sq km]",
        (0, 40),
        cv2.FONT_HERSHEY_SIMPLEX,
        0.5,
        (255, 0, 0),
        1,
        cv2.LINE_AA,
    )
    overlay_file = overlay_dir + "/" + mask_date + ".png"
    cv2.imwrite(overlay_file, cv2.cvtColor(overlay_img, cv2.COLOR_RGB2BGR))</span>
    </div>
  </div>
</div>
</div>
      
        
        <div
  class="bg-high-background border-solid border border-high-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <div class="mr-3">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clip-path="url(#clip0_1_7746)">
    <path
      d="M9.99999 6.66669V10M9.99999 13.3334H10.0083M18.3333 10C18.3333 14.6024 14.6024 18.3334 9.99999 18.3334C5.39762 18.3334 1.66666 14.6024 1.66666 10C1.66666 5.39765 5.39762 1.66669 9.99999 1.66669C14.6024 1.66669 18.3333 5.39765 18.3333 10Z"
      stroke="#D92D20" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  </g>
  <defs>
    <clipPath id="clip0_1_7746">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>
  </div>
  <div class="w-full">
  <h3 class="font-bold">PII Found</h3>
  <p class="mt-4">Path: mount_shasta_glacier_melt_monitoring.ipynb</p>
  <p class="mt-4"><b>Description</b>:</p>
  <p>A total of 1 PII found in cell number 34 with the following tag(s):</p>
  <p>
  <pre>{
    "LOCATION": 1
}</pre>
  </p>
  <p class="mt-4">
    <b>Location</b>: cell input
  </p>
  <div class="flex flex-row w-100 mt-4">
    <div class="pr-4">
      <p class="font-bold">Cell #34</p>
    </div>
    <div class="bg-white border-solid border border-none-border rounded-md overflow-x-auto w-[42rem]">
      <span class="pl-4">mont_lsts = []
lst_dates = []

for lst_file in lst_files:
    lst_date = lst_file.split("_")[5]
    lst_dates.append(lst_date)
    lst = tifffile.imread(lst_file)
    mont_lst = lst[5000:5500, 3900:4400]  # bounding box for [PII]
    mont_lst_c = (np.mean(mont_lst) * 0.00341802 + 149) - 273  # surface temperature in Celsius
    mont_lsts.append(mont_lst_c)</span>
    </div>
  </div>
</div>
</div>
       
    
  
    <div class="flex flex-row items-center">
      <span
        class="rounded-md bg-medium-base text-white text-center h-6 w-6"
        >0</span
      >
      <h2 class="text-2xl font-bold ml-2">Medium</h2>
    </div>
     
      <div
  class="bg-none-background border-solid border border-none-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <h3>No issues were found at this severity level</h3>
</div> 
    
  
    <div class="flex flex-row items-center">
      <span
        class="rounded-md bg-low-base text-white text-center h-6 w-6"
        >0</span
      >
      <h2 class="text-2xl font-bold ml-2">Low</h2>
    </div>
     
      <div
  class="bg-none-background border-solid border border-none-border rounded-xl p-4 my-2 flex flex-row w-full"
>
  <h3>No issues were found at this severity level</h3>
</div> 
    
  
</div>

    <dialog id="filesScannedDialog"
  class="p-0 border border-solid border-[#D8D8D8] rounded-md shadow-[0_1px_3px_rgba(16,24,40,0.1),0_1px_2px_rgba(16,24,40,0.06)]">
  <div class="p-4">
    <div class="flex flex-row justify-between">
      <h1 class="font-bold text-lg">Files scanned</h1>
      <a id="filesScannedCloseButton" class="cursor-pointer flex items-center">
        <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M17.5 7.5L7.5 17.5M7.5 7.5L17.5 17.5" stroke="black" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round" />
</svg>
      </a>
    </div>
    <ul class="md:mr-14">
      
      <li class="font-semibold text-xs mt-4">Notebooks</li>
      <ul class="text-sm font-mono">
        
        <li>/Users/david/Desktop/amazon_segemaker_examples/mount_shasta_glacier_melt_monitoring.ipynb </li>
        
      </ul>
      
      <li class="font-semibold text-xs mt-4">Requirements</li>
      <ul class="text-sm font-mono">
        
      </ul>
      
    </ul>
  </div>
</dialog>

    <footer class="my-4">
  <div>
    <span class="text-muted">Powered by: <a href="https://protectai.com/" target="_blank" rel="noreferrer"
        class="underline text-blue-600 hover:text-blue-800">Protect AI</a></span>
  </div>
</footer>

    <script>
  const filesScannedButton = document.getElementById('filesScannedButton');
  const filesScannedDialog = document.getElementById('filesScannedDialog');
  const filesScannedCloseButton = document.getElementById('filesScannedCloseButton');

  filesScannedButton.addEventListener('click', () => {
    if (typeof filesScannedDialog.showModal === 'function') {
      filesScannedDialog.showModal();
    }
  });

  // Allows click outside of dialog to close dialog
  filesScannedDialog.addEventListener('click', () => {
    filesScannedDialog.close();
  });

  // Add close button
  filesScannedCloseButton.addEventListener('click', () => {
    filesScannedDialog.close();
  })

  filesScannedDialog.firstElementChild.addEventListener('click', (event) => {
    event.stopPropagation();
  });
</script>
</body>
